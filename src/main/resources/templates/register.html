<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Register</title>
</head>

<body>

<h2>Register</h2>
<!-- Kayıt sayfası -->

<div th:if="${param.error == 'exists'}">
    <!-- Email zaten varsa gösterilir -->

    <p style="color:red;">Email already exists</p>
</div>

<form method="post" action="/register">
    <!-- Bu POST isteğini AuthController karşılar -->

    <div>
        <label>Username</label>
        <input type="text" name="username" required />
    </div>

    <div>
        <label>Email</label>
        <input type="email" name="email" required />
    </div>

    <div>
        <label>Password</label>
        <input type="password" name="password" required />
    </div>

    <div>
        <label>Role (optional)</label>
        <input type="text" name="role" placeholder="ROLE_ADMIN or ROLE_USER" />
        <!-- Admin olmak isteyen kullanıcı rol girebilir -->
    </div>

    <div>
        <label>Admin Secret (optional)</label>
        <input type="text" name="adminSecret" placeholder="ADMIN_REGISTER_SECRET" />
        <!-- Admin olmak için gizli anahtar -->
    </div>

    <input type="hidden"
           th:name="${_csrf.parameterName}"
           th:value="${_csrf.token}" />
    <!--
    Cross-Site Request Forgery (CSRF) Protection
    Bu gizli alan, formun gerçekten bu site tarafından üretildiğini kanıtlar.
    Kullanıcı giriş yaptıktan sonra Spring Security tarafından üretilen CSRF token’ı gönderir.
    Eğer bu token gönderilmezse veya yanlışsa, Spring Security isteği reddeder.
    POST isteklerinde zorunludur. Yanlış olursa Forbidden 403 döner.
    -->

    <button type="submit">Register</button>
</form>

<p>
    <a href="/login">Back to Login</a>
</p>

</body>
</html>
